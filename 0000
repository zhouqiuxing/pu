webpackJsonp([4],{11:function(module,exports,__webpack_require__){__webpack_require__("Ky38"),module.exports=__webpack_require__("6pnU")},"6UuD":function(module,exports){module.exports=vendor0_67149bdffff34755a000},"6pnU":function(module,exports,__webpack_require__){"use strict";var __WEBPACK_AMD_DEFINE_RESULT__,_setToken=__webpack_require__("Vp7b"),_jquery2=function(obj){return obj&&obj.__esModule?obj:{default:obj}}(__webpack_require__("g0B6")),_framework=__webpack_require__("dizD");__webpack_require__("KG7n");var _time_info=__webpack_require__("Exi7");void 0!==(__WEBPACK_AMD_DEFINE_RESULT__=function(require,exports,module){function openMiaoErrTip(status){switch(7!=status&&(_framework.MySoft.tools.cancelPop("securityVerificationTip",{mask_id:"mask_securityVerificationTip"}),_jquery2.default.mask.show({mask_id:"mask_miaoshaTip"}),(0,_jquery2.default)("#mask_miaoshaTip").off(".mask"),(0,_jquery2.default)("#mask_miaoshaTip").on("click.mask",function(){closeMiaoErrTip()}),(0,_jquery2.default)("#btn_tip_1,#btn_tip_2").hide(),4==status?(0,_jquery2.default)("#btn_tip_2").show():(0,_jquery2.default)("#btn_tip_1").show()),status.toString()){case"2":(0,_jquery2.default)("#miaoshaTip .content").html("<div>资格失效,</div><div>请速与开发商联系。</div>");break;case"4":(0,_jquery2.default)("#miaoshaTip .content").html("<div>您已有选中房源，</div><div>请查看订单。</div>");break;case"5":(0,_jquery2.default)("#miaoshaTip .content").html("<div>活动暂未开始，敬请期待。</div>");break;case"6":(0,_jquery2.default)("#miaoshaTip .content").html("<div>网络异常，请稍后再试。</div>");break;case"7":_jquery2.default.openTipLayer({content:"答案错误，请重新选择。"});var okObj=(0,_jquery2.default)("#securityVerification");okObj.addClass("disabled"),_framework.MySoft.tools.timer({seconds:2,callback:function(){okObj.removeClass("disabled")}})}7!=status&&(0,_jquery2.default)("#miaoshaTip").show()}function closeMiaoErrTip(){_framework.MySoft.tools.cancelPop("miaoshaTip",{mask_id:"mask_miaoshaTip"})}function submitOrder(question_option_id){var options={url:"/index.php?r=choose-room/submit-order",data:{token:_setToken.token,chooseRoomId:chooseRoomId,randomCode:randomCode,question_option_id:question_option_id},success:function(result){var status=result.data.status.toString();switch(status){case"2":case"4":case"5":case"6":case"7":openMiaoErrTip(status);break;case"3":(0,_jquery2.default)("#roomOtherSelectedTip_content").html(_jquery2.default.render.temp3({token:_setToken.token,activityId:_setToken.activityId,data:result.data})),_jquery2.default.mask.show({mask_id:"mask_roomOtherSelectedTip"}),(0,_jquery2.default)("#roomOtherSelectedTip").show();break;default:window.location.href="success.html?token="+_setToken.token+"&isBeta="+result.data.isBeta+"&orderId="+result.data.orderId}}};_framework.MySoft.tools.ajax(options)}function bindEvent(){(0,_jquery2.default)("#roomList").on("click",function(){window.location.href="room_list.html?activityId="+_setToken.activityId+"&token="+_setToken.token}),(0,_jquery2.default)("#favoriteList").on("click",function(){window.location.href="my_favorite.html?activityId="+_setToken.activityId+"&token="+_setToken.token}),(0,_jquery2.default)("#favrite").on("click",function(){var obj=(0,_jquery2.default)(this).find("i"),obj2=(0,_jquery2.default)(this).find(".fz12"),hasSelected=obj.hasClass("icon-likeselected")&&obj.hasClass("color1"),options={url:"/index.php?r=choose-room/collect",data:{token:_setToken.token,chooseRoomId:chooseRoomId,isCollect:hasSelected?0:1},success:function(result){var data=result.data;!hasSelected&&data.isFavoriteFull?(obj.removeClass("icon-like").addClass("icon-likeselected color-foward"),obj2.text("收藏已满"),_jquery2.default.openTipLayer({content:"房源收藏人数已达"+data.roomFavoriteLimit+"人上限。"})):_jquery2.default.openTipLayer({content:hasSelected?"取消收藏成功":"收藏成功",callback:function(){hasSelected?(obj.removeClass("icon-likeselected color1 color-foward").addClass("icon-like"),obj2.text("收藏")):(obj.removeClass("icon-like").addClass("icon-likeselected color1"),obj2.text(data.roomFavoriteCount))}})}};_framework.MySoft.tools.ajax(options)}),(0,_jquery2.default)("#step2,#step4").on("click",function(){if(!(0,_jquery2.default)(this).hasClass("disabled")){var options={url:"/index.php?r=choose-room/get-random-code",type:"get",data:{token:_setToken.token,chooseRoomId:chooseRoomId},success:function(result){randomCode=result.data.randomCode,(0,_jquery2.default)("#confirmOrderTip").data("question",result.data.question),_jquery2.default.mask.show({mask_id:"mask_confirmOrderTip"}),(0,_jquery2.default)("#confirmOrderTip").show()}};_framework.MySoft.tools.ajax(options)}}),(0,_jquery2.default)("#confirmOrderTip").on("click",function(e){var target=(0,_jquery2.default)(e.target);if(target.closest(".cancel").length)_framework.MySoft.tools.cancelPop("confirmOrderTip",{mask_id:"mask_confirmOrderTip"});else{if(target.closest(".ok").length){if((0,_jquery2.default)("#orderAgree").find(".icon-checkbg").filter(":visible").length>0)return void _jquery2.default.openTipLayer({content:"请先同意"+(0,_jquery2.default)("#orderAgree .color-more").text()});_framework.MySoft.tools.cancelPop("confirmOrderTip",{mask_id:"mask_confirmOrderTip"});var question=(0,_jquery2.default)("#confirmOrderTip").data("question");void 0===question||null==question?submitOrder(0):((0,_jquery2.default)("#securityVerification_content").html(_jquery2.default.render.temp2(question)),_jquery2.default.mask.show({mask_id:"mask_securityVerificationTip"}),(0,_jquery2.default)("#securityVerificationTip").show())}target.closest("#orderAgree").length&&0==target.closest("a").length&&((0,_jquery2.default)("#orderAgree").find(".icon-check").filter(":visible").length>0?((0,_jquery2.default)("#orderAgree").find(".icon-check").hide(),(0,_jquery2.default)("#orderAgree").find(".icon-checkbg").show()):((0,_jquery2.default)("#orderAgree").find(".icon-checkbg").hide(),(0,_jquery2.default)("#orderAgree").find(".icon-check").show()))}}),(0,_jquery2.default)("#miaoshaTip").on("click",".close_ok",function(){closeMiaoErrTip()}),(0,_jquery2.default)("#securityVerificationTip").on("click",function(e){var target=(0,_jquery2.default)(e.target);if(target.closest(".options").length&&((0,_jquery2.default)("#securityVerificationTip .icon-check").removeClass("icon-check color1").addClass("icon-checkbg color8"),target.closest(".options").find("i").removeClass("icon-checkbg color8").addClass("icon-check color1")),target.closest(".cancel").length)_framework.MySoft.tools.cancelPop("securityVerificationTip",{mask_id:"mask_securityVerificationTip"});else{var okObj=target.closest(".ok");if(okObj.length){if(okObj.hasClass("disabled"))return;if(0==(0,_jquery2.default)("#securityVerificationTip .icon-check").length)return void _jquery2.default.openTipLayer({content:"请选择一个答案"});submitOrder((0,_jquery2.default)("#securityVerificationTip .icon-check").attr("vid"))}}}),(0,_jquery2.default)("#refresh").on("click",function(){if((0,_jquery2.default)(this).hasClass("disabled"))return!1;initData()}),(0,_jquery2.default)("#roomOtherSelectedTip").on("click",".cancel",function(){_framework.MySoft.tools.cancelPop("roomOtherSelectedTip",{mask_id:"mask_roomOtherSelectedTip"})})}function initData(){var options={url:"/index.php?r=choose-room/room",type:"get",data:{token:_setToken.token,chooseRoomId:chooseRoomId},success:function(result){var data=result.data,regularStartDate=data.activityInfo.regularStartDate;data.activityInfo.regularYear=0,regularStartDate.length>4&&(data.activityInfo.regularYear=regularStartDate.substring(0,4)-0),(0,_jquery2.default)("#wrap").html(_jquery2.default.render.temp({token:_setToken.token,activityId:_setToken.activityId,chooseRoomId:chooseRoomId,data:data})),_framework.MySoft.tools.setTitle(data.roomFullNameNoProjName),_framework.MySoft.tools.timer({seconds:2,callback:function(){(0,_jquery2.default)("#refresh").removeClass("disabled")}}),(0,_time_info.setRoomTimeInfo)(data),bindEvent()},resultCustomFalseFun:function(result){"2701011"==result.retCode?(0,_jquery2.default)("#wrap").html(_jquery2.default.templates("#wrap_hasSale_Template").render({token:_setToken.token,activityId:_setToken.activityId})):_jquery2.default.openTipLayer({content:result.retMsg})}};_framework.MySoft.tools.ajax(options)}__webpack_require__("7tqI"),__webpack_require__("T7vB"),__webpack_require__("/o7J"),__webpack_require__("vWne");var chooseRoomId=_jquery2.default.url.param("chooseRoomId"),randomCode="";_jquery2.default.templates({temp:{markup:"#wrap_Template",helpers:{formatCurrency:function(value){return _framework.MySoft.tools.formatCurrency(value)},formatArea:function(value){return _framework.MySoft.tools.formatArea(value)}}},temp2:{markup:"#securityVerification_content_Template",helpers:{fromCharCode:function(value){return String.fromCharCode(value-0+65)}}},temp3:{markup:"#roomOtherSelectedTip_content_Template",helpers:{formatCurrency:function(value){return _framework.MySoft.tools.formatCurrency(value)}}}}),(0,_jquery2.default)(function(){initData()})}.call(exports,__webpack_require__,exports,module))&&(module.exports=__WEBPACK_AMD_DEFINE_RESULT__)},"7tqI":function(module,exports){},Exi7:function(module,exports,__webpack_require__){"use strict";function beginTimer(index,_callback){var obj=$("#step"+index),seconds=obj.attr("seconds")-0;if(seconds<=10&&(ten_seconds=seconds),seconds>0){obj.css("display","block");seconds>86398?$("#step_sub1_"+index).show():$("#step_sub2_"+index).show(),seconds<10&&tenSencondsTimer(index),_framework.MySoft.tools.timer({cacheObj:obj,obj:obj.find("span"),seconds:seconds,format:"hh时mm分ss秒",run_second:86400,run_callback:function(second){86400==second+2&&($("#step_sub1_"+index).hide(),$("#step_sub2_"+index).show()),9==second&&(ten_seconds=second+1,tenSencondsTimer(index))},callback:function(){obj.hide(),$("#step"+(index+1)).css("display","block"),_callback&&_callback()}})}else obj.hide(),$("#step"+(index+1)).css("display","block"),_callback&&_callback()}function leftTimer(index,_callback2){var obj=$("#step"+index),seconds=obj.attr("seconds")-0;seconds>0?_framework.MySoft.tools.timer({cacheObj:obj,seconds:seconds,obj:obj.find("span"),format:"dd天hh时mm分ss秒",dayAlwaysShow:!1,callback:function(){4!=index?obj.hide():obj.text(expiredTip),_callback2&&_callback2()}}):(4!=index?obj.hide():obj.text(expiredTip),_callback2&&_callback2())}function tenSencondsTimer(index){var obj=$("#ten_senconds_div"),seconds=ten_seconds;seconds>0?_framework.MySoft.tools.timer({cacheObj:obj,seconds:seconds,obj:obj.find("#ten_senconds"),format:"ss",callback:function(){_framework.MySoft.tools.cancelPop("ten_senconds_div",{mask_id:"mask_ten_senconds"}),$("#step"+index).hide(),$("#step"+(index+1)).css("display","block"),leftTimer(index+1)}}):(_framework.MySoft.tools.cancelPop("ten_senconds_div",{mask_id:"mask_ten_senconds"}),$("#step"+index).hide(),$("#step"+(index+1)).css("display","block"),leftTimer(index+1)),$.mask.show({mask_id:"mask_ten_senconds",opacity:.8,background:"#09007d"}),obj.show()}Object.defineProperty(exports,"__esModule",{value:!0}),exports.setRoomTimeInfo=exports.setTimeInfo=void 0,__webpack_require__("g0B6");var _framework=__webpack_require__("dizD");__webpack_require__("KG7n");var ten_seconds=10,isCanChooseRoom=!0,expiredTip="活动已过期";$(function(){$("#ten_senconds_div .icon-close").click(function(){_framework.MySoft.tools.cancelPop("ten_senconds_div",{mask_id:"mask_ten_senconds"})})}),exports.setTimeInfo=function(data){var regularStartDate=data.timeInfo.regularStartDate;data.timeInfo.regularYear=0,regularStartDate.length>4&&(data.timeInfo.regularYear=regularStartDate.substring(0,4)-0),$("#time_tip_area").html($.templates("#time_tip_area_Template").render(data.timeInfo)),(isCanChooseRoom=-1!=data.timeInfo.activityStatus)||(expiredTip="暂无选房权限"),data.timeInfo.activityStatus<2&&isCanChooseRoom?($("#gongche_tip").show(),$("#zhengshi_tip").hide()):($("#gongche_tip").hide(),isCanChooseRoom&&$("#zhengshi_tip").show()),beginTimer(1,function(){leftTimer(2,function(){$("#gongche_tip").hide(),isCanChooseRoom&&$("#zhengshi_tip").show(),$("#tab_2_rooms .content .hover").removeClass("hover"),beginTimer(3,function(){leftTimer(4)})})})},exports.setRoomTimeInfo=function(data){(isCanChooseRoom=-1!=data.activityInfo.activityStatus)||(expiredTip="暂无选房权限"),$("#step1").length>0&&beginTimer(1,function(){leftTimer(2,function(){beginTimer(3,function(){isCanChooseRoom&&($(".hide_price").hide(),$(".show_price").show()),leftTimer(4,function(){$("#step4").addClass("disabled").attr("href","javascript:;")})})})})}},Ky38:function(module,exports,__webpack_require__){module.exports=__webpack_require__("6UuD")(3)},T7vB:function(module,exports){},g0B6:function(module,exports,__webpack_require__){module.exports=__webpack_require__("6UuD")(10)}},[11]);
//# sourceMappingURL=room-92d8068c3a76f304b103.js.map